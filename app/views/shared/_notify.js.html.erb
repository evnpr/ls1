<script type="text/javascript">
notiftimer=setInterval("retrieveNotif();",10000);
    
function retrieveNotif(){
    $.ajax({
        type: "POST",
        url: "/lsgit/index",
        data: "path='<%= @current_path %>-__-'",
        dataType: "json",
        success: function(result){     
            //alert(result[0].name)
          notifyMe(result);
        }
    });    
}

function notifyMe(notif){
    var alertelement=$('div[name="notifyalert"]')[0];
    var parent=alertelement.parentNode;
    alertelement.childNodes[1].innerHTML=notif[0].name;
    //alertelement.childNodes[1].nodeValue=notif[0].name;
    alertelement.style.display="block";
    $alertelement=$(alertelement);
    $alertelement.mouseout(function(){
        setTimeout(function(){
            alertelement.style.display="none"; deleteNotif();}, 2000)
    });
    for(var i=1;i<notif.length;i++){  
        if($('div[name="notifyalert"]').length < notif.length){
            var temp=alertelement.cloneNode(true);
            $temp=$(temp);
            temp.childNodes[1].innerHTML=notif[i].name;
            //temp.childNodes[1].nodeValue=notif[i].name+"</br>"+notif[i].created_at;
            //$temp.attribute("id","notifalert_"+i);
            temp.style.display="block";       
            $temp.mouseout(function(){
                setTimeout(function(){
                    temp.style.display="none"; deleteNotif();}, 2000)
            });
            parent.appendChild(temp);
        }
    }
   
}

function deleteNotif(){
         
        $.post('/lsgit/deleteNotif', { path: '<%=@current_path%>-__-' });
}

</script>
